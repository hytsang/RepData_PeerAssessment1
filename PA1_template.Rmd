---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r}
echo = TRUE
setwd("C:/Users/Howard/Documents/Coursera Data Science Stream/05. Report Writing/Project 1/")
activity <- NULL
activity <- read.csv("activity.csv", header = T, sep = ",")
unzip(zipfile="activity.zip")
data <- read.csv("activity.csv")
```

The variable created during by this code are set to NULL.

```{r}
echo = TRUE
df_summary <- NULL
su2 <- NULL
su <- NULL
mn_int <- NULL
activity2 <- NULL
mean_su2 <- NULL
median_su2 <- NULL
activity2_weekend <- NULL
activity2_weekday <- NULL
mean_activity2_weekday <- NULL
mean_activity2_weekend <- NULL
```

## What is mean total number of steps taken per day?

```{r}
echo = TRUE
su <- tapply(activity$steps, activity$date, sum, na.rm=T)
```

Hereafter is presented a histogram of the total number of steps taken each day.

```{r}
echo = TRUE
hist(su, xlab = "sum of steps per day", main = "histogram of steps per day")
```

```{r}
echo = TRUE
mean_su <- round(mean(su))
median_su <- round(median(su))
print(c("The mean is",mean_su))
```

```{r}
print(c("The median is",median_su))
```


## What is the average daily activity pattern?

```{r}
echo = TRUE
mn_int <- tapply(activity$steps, activity$interval, mean, na.rm=T)
plot(mn_int ~ unique(activity$interval), type="l", xlab = "5-min interval")
```

The 5-minute interval (on average across all the days in the dataset) that contains the maximum number of steps.

```{r}
echo = TRUE
mn_int[which.max(mn_int)]
```

## Imputing missing values

```{r}
missing <- is.na(data$steps)
# How many missing
table(missing)
```

# Replace each missing value with the mean value of its 5-minute interval
```{r}
echo = TRUE
activity2 <- activity  # creation of the dataset that will have no more NAs
for (i in 1:nrow(activity)){
    if(is.na(activity$steps[i])){
        activity2$steps[i]<- mn_int[[as.character(activity[i, "interval"])]]
    }
}
```

Make a histogram of the total number of steps taken each day and calculate the mean and median total number of steps.

```{r}
echo = TRUE
su2 <- tapply(activity2$steps, activity2$date, sum, na.rm=T)
hist(su2, xlab = "sum of steps per day", main = "histogram of steps per day")
```

```{r}
mean_su2 <- round(mean(su2))
median_su2 <- round(median(su2))
```
The new values are :

```{r}
echo = TRUE
print(c("The mean is",mean_su2))
print(c("The median is",median_su2))
```

In order to compare the new values with the “old” values:

```{r}
echo = TRUE
df_summary <- rbind(df_summary, data.frame(mean = c(mean_su, mean_su2), median = c(median_su, median_su2)))
rownames(df_summary) <- c("with NA's", "without NA's")
print(df_summary)
```

For comparison with NA's and without (see earlier):

```{r}
echo = TRUE
summary(activity2)
```


## Are there differences in activity patterns between weekdays and weekends?



